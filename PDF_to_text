import os
import fitz  # PyMuPDF
from docx import Document

def pdf_to_text_first_page(pdf_path):
    doc = fitz.open(pdf_path)
    page = doc.load_page(0)  # Первая страница
    text = page.get_text()
    doc.close()
    return text

def docx_to_text_first_page(docx_path):
    doc = Document(docx_path)
    text = []
    for paragraph in doc.paragraphs:
        if paragraph.text.strip():
            text.append(paragraph.text)
        # Ограничение на примерный объем первой страницы
        if len('\n'.join(text)) > 1500:  # Эмпирическое значение
            break
    return '\n'.join(text)

def process_folder(folder_path):
    results = {}
    for file in os.listdir(folder_path):
        if file.endswith(".pdf"):
            text = pdf_to_text_first_page(os.path.join(folder_path, file))
            results[file] = text
        elif file.endswith(".docx"):
            text = docx_to_text_first_page(os.path.join(folder_path, file))
            results[file] = text
    return results

# Использование
folder_path = "your_folder_path"
text_data = process_folder(folder_path)

# Сохранение в TXT
for filename, text in text_data.items():
    with open(f"{filename}.txt", "w", encoding="utf-8") as f:
        f.write(text)